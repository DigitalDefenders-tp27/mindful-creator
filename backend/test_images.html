<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Images Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1 {
            text-align: center;
        }
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        .image-item {
            border: 1px solid #ddd;
            padding: 10px;
            border-radius: 5px;
        }
        .image-item img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            margin-bottom: 10px;
            background-color: #f5f5f5;
        }
        .image-item p {
            margin: 5px 0;
            font-size: 14px;
            word-break: break-all;
        }
        h2 {
            margin-top: 30px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Meme Images Test</h1>
    
    <h2>Frontend Public Images</h2>
    <div class="image-grid" id="frontend-public">
        <!-- Will be populated with JavaScript -->
    </div>
    
    <h2>Frontend-Memes API Images</h2>
    <div class="image-grid" id="frontend-api">
        <!-- Will be populated with JavaScript -->
    </div>
    
    <h2>Meme-Images API Images</h2>
    <div class="image-grid" id="meme-images-api">
        <!-- Will be populated with JavaScript -->
    </div>
    
    <h2>API Meme Images</h2>
    <div class="image-grid" id="api-memes">
        <!-- Will be populated with JavaScript -->
    </div>
    
    <script>
        const apiUrl = 'http://localhost:8001';
        
        // Frontend public images
        const frontendPublicGrid = document.getElementById('frontend-public');
        for (let i = 1; i <= 20; i++) {
            const imagePath = `/memes/meme_${i}.jpg`;
            addImageToGrid(frontendPublicGrid, imagePath, `Meme ${i}`, imagePath);
        }
        
        // Frontend-memes API images
        const frontendApiGrid = document.getElementById('frontend-api');
        for (let i = 1; i <= 20; i++) {
            const imagePath = `${apiUrl}/frontend-memes/meme_${i}.jpg`;
            addImageToGrid(frontendApiGrid, imagePath, `Meme ${i}`, imagePath);
        }
        
        // Meme-images API images
        const memeImagesApiGrid = document.getElementById('meme-images-api');
        for (let i = 1; i <= 10; i++) {
            const randomIndex = Math.floor(Math.random() * 6000) + 1;
            const imagePath = `${apiUrl}/meme-images/image_${randomIndex}.jpg`;
            addImageToGrid(memeImagesApiGrid, imagePath, `Image ${randomIndex}`, imagePath);
        }
        
        // API meme images
        const apiMemesGrid = document.getElementById('api-memes');
        fetch(`${apiUrl}/api/memes/real?count=10`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`API returned status ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                console.log('API memes data:', data);
                data.forEach(meme => {
                    const imagePath = `${apiUrl}/api/memes/${meme.image_name}`;
                    addImageToGrid(apiMemesGrid, imagePath, meme.text, imagePath);
                });
            })
            .catch(error => {
                console.error('Error fetching API memes:', error);
                apiMemesGrid.innerHTML = `<p>Error: ${error.message}</p>`;
            });
        
        function addImageToGrid(grid, imageSrc, text, path) {
            const item = document.createElement('div');
            item.className = 'image-item';
            
            const img = document.createElement('img');
            img.src = imageSrc;
            img.alt = text;
            img.onerror = function() {
                this.src = createPlaceholderImage(text);
                this.style.backgroundColor = '#ffdddd';
            };
            
            const textElem = document.createElement('p');
            textElem.textContent = text;
            
            const pathElem = document.createElement('p');
            pathElem.textContent = path;
            pathElem.style.color = '#666';
            pathElem.style.fontSize = '12px';
            
            item.appendChild(img);
            item.appendChild(textElem);
            item.appendChild(pathElem);
            
            grid.appendChild(item);
        }
        
        function createPlaceholderImage(text) {
            const canvas = document.createElement('canvas');
            canvas.width = 200;
            canvas.height = 200;
            const ctx = canvas.getContext('2d');
            
            // Generate background
            ctx.fillStyle = '#ffdddd';
            ctx.fillRect(0, 0, 200, 200);
            
            // Add text
            ctx.fillStyle = '#ff0000';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Image not found', 100, 100);
            ctx.fillText(text, 100, 120);
            
            return canvas.toDataURL();
        }
    </script>
</body>
</html> 